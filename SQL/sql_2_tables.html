<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>SQL.Начало</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css/main.css"> 
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    												<!--скрипт определения метонахождения-->
    <script type="text/javascript">$(function () {  
    $('.menu a').each(function () { 
        var location = window.location.href; 
        var link = this.href;  
        if(location == link) { 
            $(this).addClass('mainmenu_a');
            $(this).addClass('col');
            $(this).removeClass('mainmenu_n');
            $(this).removeClass('col-lg-6');
        }
        });
    });
    </script>
</head>
<body style=" background: #FFEB73">
	<div class="container" > 
			<div class="row" style="background: #FFBF00; border: solid;">
				<div class="col col-12">
				<h1 style="text-align: center;">Краткий справочник SQL</h3>
				<p style="text-align: right;">Языки/SQL/Работа с несколькими таблицами</p> <!--https://bootstrap-4.ru/docs/4.4/components/breadcrumb/-->
				<p style="text-align: center;">Немного об этом разделе. Он сделан без большого количества JS, так как это первый раздел. В дальнейешм это будет поправляться.</p>
				</div>
			</div>
																					<!--верхние кнопки -->
			<div class="row" style="background: #FFBF00; border-bottom: dotted; border-right: dotted; border-left: dotted">
									
								<div class = "col col-12" style="text-align: center; margin: 1% ">
									<h3>Кнопки пока не работают</h3>
									<button class="btn btn-dark" style="width: 200px">Распечатать</button>
									<button class="btn btn-dark" style="width: 200px">Сохранить</button>
									<button class="btn btn-dark" style="width: 200px">Отправить на почту</button>
									<button class="btn btn-dark" style="width: 200px">Выбрать другой раздел</button>
								</div>
			</div>

		<div class="row " style="min-height: 750px ">

																					<!--Меню -загладка -->
			<div class="col col-lg-1 menu">
										<div class="row justify-content-end" style="height: 150px; ">
											<a class="col-lg-6 mainmenu_n rounded-left" href="sql_start.html">
													<div class="mainmenutext">Введение</div>
											</a>
										</div>
										<div class="row justify-content-end" style="height: 150px ">
											<a class="col-lg-6 mainmenu_n rounded-left" href="sql_base.html" >
												<div class="mainmenutext">Основы</div>
											</a>
										</div>
										<div class="row justify-content-end" style="height: 150px ">
											<a class="col-lg-6 mainmenu_n rounded-left" href="sql_1_table.html">
												<div class="mainmenutext">1 таблица</div>
											</a>
										</div>
										<div class="row justify-content-end" style="height: 170px ">
											<a class="col-lg-6 mainmenu_n rounded-left" href="sql_2_tables.html">
												<div class="mainmenutext">Несколько таблиц</div>
											</a>
										</div>
			</div>
																					<!--Меню -загладка -->
	

			<div class="col col-lg-11" >
				<div class="row" style="height: 100%; border: ridge;">
							<div id="sec_menu" class="col col-3" style="background: #FAEEDD; border-right: 1px solid" >
								<p style="text-align: center;color: blue; font-size: 18px ">Структура раздела</p>
								<p><a style="color: blue" href="#Создание таблицы и связи между 2 таблицами">Создание таблицы и связи между 2 таблицами</a></p>
								<p><a style="color: blue" href="#Вложенные запросы">Вложенные запросы</a></p>
								<p><a style="color: blue" href="#Джоины">Джоины</a></p>
							</div>
							<div  style="background: #FAEEDD;; width: 35px;  position: relative; display: inline-block;">
									<img id="hide" src="img/arrow-bar-left.svg" alt="" style="width: 100%;" onclick="(document.getElementById('sec_menu').style.display='none', document.getElementById('hide').style.display='none', document.getElementById('block').style.display='block' )"></img>
									<img id="block" src="img/arrow-bar-right.svg" alt="" style="width: 100%; display: none;" onclick="(document.getElementById('sec_menu').style.display='block', document.getElementById('hide').style.display='block', document.getElementById('block').style.display='none' )"></img>
							</div>
					<div class="col maintext" style="background: #FAEEDD; ">
						<p><a id="Создание таблицы и связи между 2 таблицами" name="Создание таблицы и связи между 2 таблицами">Создание таблицы и связи между 2 таблицами&nbsp;</a></p>

						<p>Итак, создаем вторую таблицу</p>

						<table  border="1" cellpadding="0" cellspacing="0">
							<tbody>
								<tr>
									<td style="width:64px">
									<p>Row_id</p>
									</td>
									<td style="width:83px">
									<p>Par_row_id</p>
									</td>
									<td style="width:63px">
									<p>Work</p>
									</td>
									<td style="width:62px">
									<p>ZP</p>
									</td>
									<td style="width:62px">
									<p>Company</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>1</p>
									</td>
									<td style="width:83px">
									<p>1</p>
									</td>
									<td style="width:63px">
									<p>Тестер</p>
									</td>
									<td style="width:62px">
									<p>150000</p>
									</td>
									<td style="width:62px">
									<p>1</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>2</p>
									</td>
									<td style="width:83px">
									<p>2</p>
									</td>
									<td style="width:63px">
									<p>Тестер</p>
									</td>
									<td style="width:62px">
									<p>150000</p>
									</td>
									<td style="width:62px">
									<p>2</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>3</p>
									</td>
									<td style="width:83px">
									<p>3</p>
									</td>
									<td style="width:63px">
									<p>Аналитик</p>
									</td>
									<td style="width:62px">
									<p>50000</p>
									</td>
									<td style="width:62px">
									<p>1</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>4</p>
									</td>
									<td style="width:83px">
									<p>4</p>
									</td>
									<td style="width:63px">
									<p>Разраб</p>
									</td>
									<td style="width:62px">
									<p>80000</p>
									</td>
									<td style="width:62px">
									<p>2</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>5</p>
									</td>
									<td style="width:83px">
									<p>4</p>
									</td>
									<td style="width:63px">
									<p>Разраб</p>
									</td>
									<td style="width:62px">
									<p>80000</p>
									</td>
									<td style="width:62px">
									<p>1</p>
									</td>
								</tr>
								<tr>
									<td style="width:64px">
									<p>6</p>
									</td>
									<td style="width:83px">
									<p>5</p>
									</td>
									<td style="width:63px">
									<p>Аналитик</p>
									</td>
									<td style="width:62px">
									<p>55000</p>
									</td>
									<td style="width:62px">
									<p>2</p>
									</td>
								</tr>
							</tbody>
						</table>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>CREATE TABLE</strong></span> Work (</p>

						<p style="margin-left:40px">Row_id int AUTO_INCREMENT,</p>

						<p style="margin-left:40px">Par_row_id int NOT NULL,</p>

						<p style="margin-left:40px">Work varchar(20) NOT NULL,</p>

						<p style="margin-left:40px">ZP&nbsp; varchar(20) NOT NULL,</p>

						<p style="margin-left:40px">&nbsp;Company int NOT NULL,</p>

						<p style="margin-left:40px">PRIMARY KEY (Row_id),</p>

						<p style="margin-left:40px">FOREIGN KEY (Par_row_id) REFERENCES Telephone (Row_id) );</p>
						</div>

						<p>Для добавления связи между таблицами мы записали последнюю строчку&nbsp;</p>

						<hr />
						<p><strong><span style="color:#0000FF">FOREIGN KEY</span></strong> (имя_столбца_которое_является_внешним_ключом) <strong><span style="color:#0000FF">REFERENCES </span></strong>имя_таблицы_родителя (имя_столбца_родителя);</p>

						<hr />
						<p>Заполним таблицу (при этом в Par_row_id мы не можем вписать значение, которого нет в поле &nbsp;Row_id&nbsp; первой таблицы)</p>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>INSERT INTO</strong></span> Work (Par_row_id, Work, ZP, Company)&nbsp; <strong><span style="color:#0000FF">VALUES</span></strong> (&#39;1&#39;,&#39;Тестер&#39;, &#39;150000&#39;, &#39;1&#39;),</p>

						<p style="margin-left:40px">(&#39;2&#39;,&#39;Тестер&#39;, &#39;150000&#39;, &#39;2&#39;),</p>

						<p style="margin-left:40px">(&#39;3&#39;,&#39;Аналитик&#39;, &#39;50000&#39;, &#39;1&#39;),</p>

						<p style="margin-left:40px">(&#39;4&#39;,&#39;Разраб&#39;, &#39;80000&#39;, &#39;2&#39;),</p>

						<p style="margin-left:40px">(&#39;4&#39;,&#39;Разраб&#39;, &#39;80000&#39;, &#39;1&#39;),</p>

						<p style="margin-left:40px">(&#39;5&#39;,&#39;Аналитик&#39;, &#39;55000&#39;, &#39;2&#39;);</p>
						</div>

						<hr />
						<h2><a id="Вложенные запросы" name="Вложенные запросы">Вложенные запросы</a></h2>

						<p>Допустим, мы хотим узнать, кем работает Дмитрий. Но его имя водной таблицы, а работа в другой. Для этого будут вложенные запросы.</p>

						<p>Таблица телефон связана с работой по row_id (телефон) и par_row_id(работа).</p>

						<p>Таким образом наш селект&nbsp; будет выглядеть так</p>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>Select </strong></span>a.Work <strong><span style="color:#0000FF">from</span></strong> Work a <strong><span style="color:#0000FF">where</span></strong> a.par_row_id = (<strong><span style="color:#0000FF">select</span></strong> c.row_id <strong><span style="color:#0000FF">from</span></strong> Telephone c <span style="color:#0000FF"><strong>where</strong></span> c.First_name = &#39;Дмитрий&#39;)</p>
						</div>

						<hr />
						<table border="1" cellpadding="0" cellspacing="0" style="width:533px">
							<tbody>
								<tr>
									<td>
									<p>Work</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Аналитик</p>
									</td>
								</tr>
							</tbody>
						</table>

						<p>То есть, можно перевести так: Выбрать работу из таблицы работ, где связаывающий пар роу айди равен роу айди строки из таблицы телефонов, где имя равно Дмитрий.</p>

						<p>Или мы хотим узнать все фамилии тех, кто работает в компании 1. Но таких у нас несколько, значит мы ставим не =, а in.</p>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>Select</strong></span> a. LastName <span style="color:#0000FF"><strong>from</strong></span> telephone a <strong><span style="color:#0000FF">where</span></strong> row_id in (<span style="color:#0000FF"><strong>select</strong></span> c.par_row_id <span style="color:#0000FF"><strong>from</strong></span> work c <span style="color:#0000FF"><strong>where</strong></span> c.company = &#39;1&#39;)</p>
						</div>

						<hr />
						<table border="1" cellpadding="0" cellspacing="0" style="width:533px">
							<tbody>
								<tr>
									<td>
									<p>LastName</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Иванов</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Иванова</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Кукушкина</p>
									</td>
								</tr>
							</tbody>
						</table>

						<h2><a id="Джоины" name="Джоины">Джоины</a></h2>

						<p>Вот все джоины, но всеми я не пользуюсь, поэтому основные опишу</p>

						<p>Нам нужны телефоны, фамилии, и профессии, rкоторые находятся в разных таблицах. Используем джоин.</p>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>Select</strong></span> a. LastName as Фамилия, a.Telephone as Телефон, c.work as Работа <strong><span style="color:#0000FF">from</span></strong> Telephone a <span style="color:#0000FF"><strong>join</strong></span> work c <strong><span style="color:#0000FF">where</span></strong> a.row_id=c.par_row_id <span style="color:#0000FF"><strong>and</strong></span> c.company = &#39;1&#39;</p>
						</div>

						<hr />
						<table border="1" cellpadding="0" cellspacing="0" style="width:533px">
							<tbody>
								<tr>
									<td>
									<p>Фамилия</p>
									</td>
									<td>
									<p>Телефон</p>
									</td>
									<td>
									<p>Работа</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Иванов</p>
									</td>
									<td>
									<p>123456</p>
									</td>
									<td>
									<p>Тестер</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Иванова</p>
									</td>
									<td>
									<p>345678</p>
									</td>
									<td>
									<p>Аналитик</p>
									</td>
								</tr>
								<tr>
									<td>
									<p>Кукушкина</p>
									</td>
									<td>
									<p>456789</p>
									</td>
									<td>
									<p>Разраб</p>
									</td>
								</tr>
							</tbody>
						</table>

						<p>Этот&nbsp;же запрос можно записать и так</p>

						<hr />
						<div class="sqlcode">
						<p><span style="color:#0000FF"><strong>Select</strong></span>&nbsp;a. LastName as Фамилия, a.Telephone as Телефон, c.work as Работа <strong><span style="color:#0000FF">from</span></strong> Telephone a, work c <span style="color:#0000FF"><strong>where</strong></span> a.row_id=c.par_row_id <strong><span style="color:#0000FF">and</span></strong> c.company = &#39;1&#39;</p>
						</div>

						<p>&nbsp;</p>


					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class = "col-12" style="background: #FFBF00; border: dotted;">
			<p style="text-align: center;">ЭТО ДНИЩЕ САЙТА </p>
			</div>
		</div>
		
	</div>
	
</body>
</html>